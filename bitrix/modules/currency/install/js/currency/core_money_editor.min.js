(function(){"use strict";BX.namespace("BX.Currency");var t=BX.message("CURRENCY");BX.Currency.Editor=function(t){this.input=t.input;this.callback=t.callback;this.currency=t.currency;this.value=t.value||"";BX.ready(BX.delegate(this.init,this))};BX.Currency.Editor.prototype.init=function(){BX.bind(this.input,"bxchange",BX.proxy(this.valueEdit,this));BX.unbind(this.input,"change",BX.proxy(this.valueEdit,this))};BX.Currency.Editor.prototype.clean=function(){BX.unbind(this.input,"bxchange",BX.proxy(this.valueEdit,this));this.input=null};BX.Currency.Editor.prototype.valueEdit=function(){this.formatValue()};BX.Currency.Editor.prototype.setCurrency=function(t){this.value=BX.Currency.Editor.getUnFormattedValue(this.input.value,this.currency);this.currency=t;this.input.value=BX.Currency.Editor.getFormattedValue(this.value,this.currency);this.callValueChangeCallback()};BX.Currency.Editor.prototype.formatValue=function(){var t=BX.getCaretPosition(this.input);var e=this.input.value;this.changeValue();if(this.input.value.length>0){BX.setCaretPosition(this.input,t-e.length+this.input.value.length)}};BX.Currency.Editor.prototype.changeValue=function(){this.value=BX.Currency.Editor.getUnFormattedValue(this.input.value,this.currency);this.input.value=BX.Currency.Editor.getFormattedValue(this.value,this.currency);this.callValueChangeCallback()};BX.Currency.Editor.prototype.callValueChangeCallback=function(){if(!!this.callback){this.callback.apply(this,[this.value])}BX.onCustomEvent(this,"Currency::Editor::change",[this.value])};BX.Currency.Editor.getBaseCurrencyId=function(){for(var e in t){if(!t.hasOwnProperty(e)){break}if(BX.prop.getString(t[e],"BASE","N")==="Y"){return e}}return""};BX.Currency.Editor.trimTrailingZeros=function(e,i){if(typeof t[i]==="undefined"){return e}var r=BX.prop.getString(t[i],"DEC_POINT","");return r!==""?e.replace(new RegExp("\\"+r+"00"),""):e};BX.Currency.Editor.getUnFormattedValue=function(e,i){return e.replace(new RegExp("["+t[i]["SEPARATOR"]+"]","g"),"").replace(t[i]["DEC_POINT"],".")};BX.Currency.Editor.getFormattedValue=function(e,i){var r=e.length;var n="";if(r>0){e=e.replace(/^0+/,"");if(e.length<=0){e="0"}else if(e.charAt(0)==="."){e="0"+e}r=e.length}var u;if(t[i]["SEPARATOR"]===","||t[i]["SEPARATOR"]==="."){u=new RegExp("["+t[i]["DEC_POINT"]+"]")}else{u=new RegExp("["+t[i]["DEC_POINT"]+",.]")}var a=e.match(u);a=a===null?e.length:a.index;var l=0;for(var c=0;c<e.length;c++){var h=e.length-1-c;var o=e.charAt(h);var s="0123456789".indexOf(o)>=0;if(s){l++}if(h===a){l=0}if(h>=a){if(t[i]["DEC_POINT"]==="."&&o===","){o=t[i]["DEC_POINT"]}if(t[i]["DEC_POINT"]===","&&o==="."){o=t[i]["DEC_POINT"]}if(s||h===a&&o===t[i]["DEC_POINT"]){n=o+n}else if(r>h){r--}}else{if(s){n=o+n}else if(r>h){r--}if(s&&l%3===0&&l!==0&&h!==0){n=t[i]["SEPARATOR"]+n;if(r>=h){r++}}}}if(t[i]["DECIMALS"]>0){a=n.match(new RegExp("["+t[i]["DEC_POINT"]+"]"));a=a===null?n.length:a.index;while(n.length-1-a>t[i]["DECIMALS"]){if(r>=n.length-1){r--}n=n.substr(0,n.length-1)}}return n}})();
//# sourceMappingURL=core_money_editor.map.js